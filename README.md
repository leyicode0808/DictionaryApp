# 一、项目概述

本实验基于 Android 平台开发一款 **离线英汉词典 APP**，核心数据来源于自定义词库文件 `word_translation.csv`（已转换为 SQLite 数据库以提升查询效率）。APP 聚焦 **“离线查词、高效记词”** 核心需求，支持英文单词精确查询、查询历史自动保存、重点单词收藏、语音输入查词、翻译结果朗读与复制等实用功能，无需网络即可满足用户日常查词、学习英语的需求。

---

# 二、实验报告

## （一）灵感来源

- **无网络场景的查词需求**：用户在地铁、自习室、户外等无网络环境下，经常会遇到需要查询英文单词的场景，而传统在线词典无法使用，离线词典能有效填补这一空白；
- **学习场景的高效记词需求**：英语学习者在查词后，往往需要回顾高频查询的单词、收藏重点词汇，传统词典的 “查询即忘” 模式无法满足记词需求，因此需要新增历史记录自动保存、单词收藏功能；
- **现有工具的体验优化**：市面上部分离线词典存在广告过多、查询速度慢、功能冗余等问题，本 APP 聚焦 “轻量、高效、实用”，剔除冗余功能，强化核心查词与记词体验；
- **多场景输入与使用需求**：除手动输入单词外，用户在双手不便（如通勤时）可能需要语音输入功能；查询结果需支持朗读（辅助发音学习）和复制（方便整理笔记），覆盖更全面的使用场景。

---

## （二）开发记录

### 1. 开发准备阶段（基础环境与核心依赖搭建）

- **技术栈确定**：Android Studio（开发工具）、Java（开发语言）、SQLite（本地数据库）、Android 原生 API（语音输入、TTS 朗读、剪贴板）；
- **核心资源准备**：整理 `word_translation.csv` 词库文件，包含英文单词与对应中文翻译，后续通过代码批量导入 SQLite 数据库，确保离线查询效率；
- **权限配置**：在 `AndroidManifest.xml` 中配置录音权限（用于语音输入）、文件读写权限（用于数据库初始化），适配 Android 6.0+ 动态权限申请机制。

---

### 2. 核心功能开发阶段（数据库与核心业务逻辑）

#### SQLite 数据库设计与实现：

- 创建 `WordDatabaseHelper` 数据库帮助类，设计三张表：
    - `words`（存储词库核心数据：单词、翻译）
    - `history`（存储查询历史：单词、翻译、查询时间戳）
    - `collection`（存储收藏单词：单词）
- 实现数据库核心操作方法：
    - `queryTranslation`（精确查询单词翻译）
    - `addHistory`（添加查询历史）
    - `queryAllHistory`（查询所有历史记录）
    - `deleteHistory`（删除单条历史）
    - `addCollection`（添加收藏）
    - `removeCollection`（取消收藏）
    - `isCollected`（检查单词是否收藏）
- **词库导入**：在数据库初始化时，读取 `word_translation.csv` 文件，批量插入 `words` 表，确保离线查询的数据基础。

#### 核心查词功能开发：

- 实现手动输入查词：通过 `EditText` 接收用户输入，点击 “开始翻译” 按钮触发查询，查询结果显示在 `TextView` 中；
- 优化查询逻辑：查询操作放在子线程执行，避免阻塞主线程导致界面卡顿，查询结果通过 `Handler` 回调到主线程更新 UI；
- 自动保存查询历史：移除手动 “保存历史” 按钮，优化为 “翻译成功即自动保存”，减少用户操作，同时添加无效结果过滤（空单词、未找到翻译不保存）。

#### 单词收藏功能开发：

- 收藏状态可视化：通过 “空心星”（未收藏）和 “实心星”（已收藏）图标实时反馈单词收藏状态；
- 收藏操作逻辑：点击 “收藏单词” 按钮或收藏图标，触发收藏 / 取消收藏操作，操作结果通过 Toast 提示用户，同时更新图标状态；
- 收藏列表查看：点击 “查看收藏” 按钮，查询 `collection` 表数据，以弹窗形式展示所有收藏单词，适配少量收藏场景的快速查看。

---

### 3. 辅助功能开发阶段（提升用户体验）

#### 语音输入查词：

- 基于 Android 原生 `SpeechRecognizer` 实现语音识别功能，将识别结果自动填充到输入框，支持中文语音输入转英文单词（需确保语音识别准确率）；
- 处理语音识别异常：针对音频错误、未识别到语音、服务繁忙等场景，给出明确的 Toast 提示，提升容错性。

#### 翻译结果辅助操作：

- **TTS 朗读功能**：基于 `TextToSpeech` 实现翻译结果朗读，支持中文发音，辅助用户学习单词用法；
- **结果复制功能**：通过 `ClipboardManager` 实现翻译结果一键复制，方便用户粘贴到笔记、文档中；
- **输入与结果清除**：点击 “清除输入 / 结果” 按钮，清空输入框内容和翻译结果，重置收藏状态图标。

---

### 4. UI 布局优化与功能整合

- **布局结构调整**：删除冗余的 “保存历史” 按钮，将 “查看收藏” 按钮整合到核心功能区（`GridLayout` 布局），底部仅保留 “返回主页” 和 “词典” 预留入口，布局更简洁高效；
- **历史记录展示**：使用 `RecyclerView` 实现历史记录列表展示，支持点击历史记录重新查询翻译、长按删除单条历史，列表滚动到最新记录，提升操作便捷性；
- **适配性优化**：调整控件间距、按钮大小、文本字体，确保在不同屏幕尺寸的 Android 设备上显示正常，提升视觉体验。

---

### 5. 功能测试与问题修复

- **功能测试**：覆盖所有核心场景（离线查词、自动保存历史、收藏 / 取消收藏、语音输入、朗读、复制、历史删除），验证功能可用性；
- **性能优化**：修复数据库查询卡顿问题（子线程执行）、UI 刷新异常（`Handler` 主线程回调）、权限申请失败导致的功能不可用（添加权限说明）；
- **边界情况处理**：处理空输入、未找到翻译、重复收藏、重复添加历史等边界场景，避免崩溃，提升 APP 稳定性。

---

### 6. 预留功能扩展

- **词典页面预留**：“词典” 按钮暂未实现具体功能，后续可扩展为 “词库大全”，支持单词模糊搜索、按字母分类查看等；
- **收藏页面扩展**：当前收藏列表以弹窗展示，后续可扩展为独立的 “收藏夹” 页面，支持批量删除、收藏排序等功能；
- **词库更新**：预留词库更新接口，后续可支持通过本地文件导入新词库，扩展词库覆盖范围。